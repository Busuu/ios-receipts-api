<?php
namespace Tests\Helper;

use AppleBundle\Model\Receipt;
use Busuu\IosReceiptsApi\Model\AppStoreReceipt;

class AppleHelper
{
    private $receiptData = 'ewogICAgcG9kID0gNTA7CiAgICAicHVyY2hhc2UtaW5mbyIgPSAiZXdvSkluRjFZVzUwYVhSNUlpQTlJQ0l4SWpzS0NTSnZjbWxuYVc1aGJDMXdkWEpqYUdGelpTMWtZWFJsSWlBOUlDSXlNREUyTFRBNExURTJJREUyT2pReU9qVXpJRVYwWXk5SFRWUWlPd29KSW1KcFpDSWdQU0FpWTI5dExtSjFjM1YxTG1WdVoyeHBjMmd1WVhCd0lqc0tDU0p3ZFhKamFHRnpaUzFrWVhSbExXMXpJaUE5SUNJeE5EY3hNelkxTnpjek9ETTJJanNLQ1NKMlpYSnphVzl1TFdWNGRHVnlibUZzTFdsa1pXNTBhV1pwWlhJaUlEMGdJamd4T0RNeU1qVTFOU0k3Q2draWRISmhibk5oWTNScGIyNHRhV1FpSUQwZ0ltTnZiUzVpZFhOMWRTNWhjSEF1YzNWaWN6RXliVzl1ZEdodmNIUnBiMjVETG5KMWMzTnBZVEUwTnpFek5qVTNOek00TXpNaU93b0pJbkIxY21Ob1lYTmxMV1JoZEdVdGNITjBJaUE5SUNJeU1ERTJMVEE0TFRFMklEQTVPalF5T2pVeklFRnRaWEpwWTJFdlRHOXpYMEZ1WjJWc1pYTWlPd29KSW1sMFpXMHRhV1FpSUQwZ0lqRXdNakUyTlRReE1qSWlPd29KSW5CeWIyUjFZM1F0YVdRaUlEMGdJbU52YlM1aWRYTjFkUzVoY0hBdWMzVmljekV5Ylc5dWRHaHZjSFJwYjI1RExuSjFjM05wWVNJN0Nna2lkVzVwY1hWbExXbGtaVzUwYVdacFpYSWlJRDBnSWpFeU5tVXhZalF4TTJRd056VXlaalEwT0dKaFlqSTJPRFUyTjJZNU5ERXdabUZsWTJZMU5tUWlPd29KSW5WdWFYRjFaUzEyWlc1a2IzSXRhV1JsYm5ScFptbGxjaUlnUFNBaU1EY3dSak13UXpRdE1UbEJOQzAwT0RrM0xVSkNSakV0UVRWRE9VWTFNMFEzTkRjMUlqc0tDU0poY0hBdGFYUmxiUzFwWkNJZ1BTQWlNemM1T1RZNE5UZ3pJanNLQ1NKdmNtbG5hVzVoYkMxd2RYSmphR0Z6WlMxa1lYUmxMWEJ6ZENJZ1BTQWlNakF4Tmkwd09DMHhOaUF3T1RvME1qbzFNeUJCYldWeWFXTmhMMHh2YzE5QmJtZGxiR1Z6SWpzS0NTSnZjbWxuYVc1aGJDMXdkWEpqYUdGelpTMWtZWFJsTFcxeklpQTlJQ0l4TkRjeE16WTFOemN6T0RNMklqc0tDU0p2Y21sbmFXNWhiQzEwY21GdWMyRmpkR2x2YmkxcFpDSWdQU0FpWTI5dExtSjFjM1YxTG1Gd2NDNXpkV0p6TVRKdGIyNTBhRzl3ZEdsdmJrTXVjblZ6YzJsaE1UUTNNVE0yTlRjM016Z3pNeUk3Q2draVluWnljeUlnUFNBaU1pSTdDZ2tpY0hWeVkyaGhjMlV0WkdGMFpTSWdQU0FpTWpBeE5pMHdPQzB4TmlBeE5qbzBNam8xTXlCRmRHTXZSMDFVSWpzS2ZRPT0iOwogICAgc2lnbmF0dXJlID0gIkFwZHhKZHROd1BVMnJBNS9jbjNrSU8xT1RrMjVmZURLYTBhYWd5eVJ2ZVdsY0ZsZ2x2NlJGNnpua2lCUzN1bTlVYzdwVm9iK1BxWlIyVDh3eVZySE5wbG9mM0RYM0lxRE9sV3ErOTBhN1lsK3FyUjdBN2pXd3ZpdzcwOFBTKzY3UHlIUm5oTy9HN2JWcWdScEVyNkV1RnliaVUxRlhBaVhKYzZsczFZQXNzUXhBQUFEVnpDQ0ExTXdnZ0k3b0FNQ0FRSUNDR1VVa1UzWldBUzFNQTBHQ1NxR1NJYjNEUUVCQlFVQU1IOHhDekFKQmdOVkJBWVRBbFZUTVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEV6TURFR0ExVUVBd3dxUVhCd2JHVWdhVlIxYm1WeklGTjBiM0psSUVObGNuUnBabWxqWVhScGIyNGdRWFYwYUc5eWFYUjVNQjRYRFRBNU1EWXhOVEl5TURVMU5sb1hEVEUwTURZeE5ESXlNRFUxTmxvd1pERWpNQ0VHQTFVRUF3d2FVSFZ5WTJoaGMyVlNaV05sYVhCMFEyVnlkR2xtYVdOaGRHVXhHekFaQmdOVkJBc01Fa0Z3Y0d4bElHbFVkVzVsY3lCVGRHOXlaVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTXdnWjh3RFFZSktvWklodmNOQVFFQkJRQURnWTBBTUlHSkFvR0JBTXJSakYyY3Q0SXJTZGlUQ2hhSTBnOHB3di9jbUhzOHAvUndWL3J0LzkxWEtWaE5sNFhJQmltS2pRUU5mZ0hzRHM2eWp1KytEcktKRTd1S3NwaE1kZEtZZkZFNXJHWHNBZEJFakJ3Ukl4ZXhUZXZ4M0hMRUZHQXQxbW9LeDUwOWRoeHRpSWREZ0p2MllhVnM0OUIwdUp2TmR5NlNNcU5OTEhzREx6RFM5b1pIQWdNQkFBR2pjakJ3TUF3R0ExVWRFd0VCL3dRQ01BQXdId1lEVlIwakJCZ3dGb0FVTmgzbzRwMkMwZ0VZdFRKckR0ZERDNUZZUXpvd0RnWURWUjBQQVFIL0JBUURBZ2VBTUIwR0ExVWREZ1FXQkJTcGc0UHlHVWpGUGhKWENCVE16YU4rbVY4azlUQVFCZ29xaGtpRzkyTmtCZ1VCQkFJRkFEQU5CZ2txaGtpRzl3MEJBUVVGQUFPQ0FRRUFFYVNiUGp0bU40Qy9JQjNRRXBLMzJSeGFjQ0RYZFZYQWVWUmVTNUZhWnhjK3Q4OHBRUDkzQmlBeHZkVy8zZVRTTUdZNUZiZUFZTDNldHFQNWdtOHdyRm9qWDBpa3lWUlN0USsvQVEwS0VqdHFCMDdrTHM5UVVlOGN6UjhVR2ZkTTFFdW1WL1VndkRkNE53Tll4TFFNZzRXVFFmZ2tRUVZ5OEdYWndWSGdiRS9VQzZZNzA1M3BHWEJrNTFOUE0zd294aGQzZ1NSTHZYaitsb0hzU3RjVEVxZTlwQkRwbUc1K3NrNHR3K0dLM0dNZUVONS8rZTFRVDlucC9LbDFuaithQnc3QzB4c3kwYkZuYUFkMWNTUzZ4ZG9yeS9DVXZNNmd0S3Ntbk9PZHFUZXNicDBiczhzbjZXcXMwQzlkZ2N4Ukh1T01aMnRtOG5wTFVtN2FyZ09TelE9PSI7CiAgICAic2lnbmluZy1zdGF0dXMiID0gMDsKfQ==';

    public function getReceiptData()
    {
        return $this->receiptData;
    }

    /**
     * @param bool $expired
     * @return AppStoreReceipt
     */
    public function getStoreReceipt($expired = false)
    {
        $nowMs = time() * 1000;
        $storeReceipt = new AppStoreReceipt();
        $storeReceipt
            ->setExpiresDateMs($expired ? $nowMs - 100000 : $nowMs + 100000)
            ->setOriginalTransactionId('460000184056394')
            ->setProductId('com.busuu.app.subs1month.china_fr')
            ->setOriginalPurchaseDateMs(1466520984000)
        ;

        return $storeReceipt;
    }

    public function getStoreReceiptDataValidSubscription()
    {
        return json_decode('{"status":0,"environment":"Production","receipt":{"receipt_type":"Production","adam_id":379968583,"app_item_id":379968583,"bundle_id":"com.busuu.english.app","application_version":"2","download_id":75007999904088,"version_external_identifier":818322555,"receipt_creation_date":"2016-08-17 11:03:53 Etc\/GMT","receipt_creation_date_ms":"1471431833000","receipt_creation_date_pst":"2016-08-17 04:03:53 America\/Los_Angeles","request_date":"2016-08-17 16:04:03 Etc\/GMT","request_date_ms":"1471449843432","request_date_pst":"2016-08-17 09:04:03 America\/Los_Angeles","original_purchase_date":"2015-08-06 17:57:23 Etc\/GMT","original_purchase_date_ms":"1438883843000","original_purchase_date_pst":"2015-08-06 10:57:23 America\/Los_Angeles","original_application_version":"1","in_app":[{"quantity":"1","product_id":"com.busuu.app.subs1monthoptionC.switzerland","transaction_id":"350000159445075","original_transaction_id":"350000159445075","purchase_date":"2016-08-17 11:03:52 Etc\/GMT","purchase_date_ms":"1471431832487","purchase_date_pst":"2016-08-17 04:03:52 America\/Los_Angeles","original_purchase_date":"2016-08-17 11:03:53 Etc\/GMT","original_purchase_date_ms":"1471431833000","original_purchase_date_pst":"2016-08-17 04:03:53 America\/Los_Angeles","expires_date":"2016-09-17 11:03:52 Etc\/GMT","expires_date_ms":"1474110232487","expires_date_pst":"2016-09-17 04:03:52 America\/Los_Angeles","web_order_line_item_id":"350000026263678","is_trial_period":"false"}]},"latest_receipt_info":[{"quantity":"1","product_id":"com.busuu.app.subs1monthoptionC.switzerland","transaction_id":"350000159445075","original_transaction_id":"350000159445075","purchase_date":"2016-08-17 11:03:52 Etc\/GMT","purchase_date_ms":"1471431832487","purchase_date_pst":"2016-08-17 04:03:52 America\/Los_Angeles","original_purchase_date":"2016-08-17 11:03:53 Etc\/GMT","original_purchase_date_ms":"1471431833000","original_purchase_date_pst":"2016-08-17 04:03:53 America\/Los_Angeles","expires_date":"2016-09-17 11:03:52 Etc\/GMT","expires_date_ms":"1474110232487","expires_date_pst":"2016-09-17 04:03:52 America\/Los_Angeles","web_order_line_item_id":"350000026263678","is_trial_period":"false"}],"latest_receipt":"ZZZ"}', true);
    }

    /**
     * Returns a store receipt array with multiple subscriptions (within 'in_app' and 'latest_receipt_info').
     *
     * Within 'latest_receipt_info', there are 2 subscriptions - the differences being in the following keys:
     *
     *  - transaction_id, purchase_date, purchase_date_ms, purchase_date_pst, expires_date, expires_date_ms,
     *      expires_date_pst and web_order_line_item_id.
     */
    public function getStoreReceiptMultipleSubscriptions()
    {
        return json_decode('{"status":0,"environment":"Production","receipt":{"receipt_type":"Production","adam_id":372967583,"app_item_id":372967583,"bundle_id":"com.busuu.english.app","application_version":"2","download_id":83018699139059,"version_external_identifier":818532555,"receipt_creation_date":"2015-10-13 10:38:22 Etc/GMT","receipt_creation_date_ms":"1444732702000","receipt_creation_date_pst":"2015-10-13 03:38:22 America/Los_Angeles","request_date":"2018-01-05 11:42:07 Etc/GMT","request_date_ms":"1515152527633","request_date_pst":"2018-01-05 03:42:07 America/Los_Angeles","original_purchase_date":"2015-07-09 11:00:20 Etc/GMT","original_purchase_date_ms":"1436439620075","original_purchase_date_pst":"2015-07-09 04:00:20 America/Los_Angeles","original_application_version":"1","in_app":[{"quantity":"1","product_id":"com.busuu.app.subs1monthoptionC.switzerland","transaction_id":"140000164972207","original_transaction_id":"140000164971107","purchase_date":"2015-10-13 10:38:17 Etc/GMT","purchase_date_ms":"1444732697000","purchase_date_pst":"2015-10-13 03:38:17 America/Los_Angeles","original_purchase_date":"2015-10-13 10:38:22 Etc/GMT","original_purchase_date_ms":"1444732702000","original_purchase_date_pst":"2015-10-13 03:38:22 America/Los_Angeles","expires_date":"2015-11-13 11:38:17 Etc/GMT","expires_date_ms":"1447414697000","expires_date_pst":"2015-11-13 03:38:17 America/Los_Angeles","web_order_line_item_id":"140000019536111","is_trial_period":"false"}]},"latest_receipt_info":[{"quantity":"1","product_id":"com.busuu.app.subs1monthoptionC.switzerland","transaction_id":"140000164972207","original_transaction_id":"140000164971107","purchase_date":"2015-10-13 10:38:17 Etc/GMT","purchase_date_ms":"1444732697000","purchase_date_pst":"2015-10-13 03:38:17 America/Los_Angeles","original_purchase_date":"2015-10-13 10:38:22 Etc/GMT","original_purchase_date_ms":"1444732702000","original_purchase_date_pst":"2015-10-13 03:38:22 America/Los_Angeles","expires_date":"2015-11-13 11:38:17 Etc/GMT","expires_date_ms":"1447414697000","expires_date_pst":"2015-11-13 03:38:17 America/Los_Angeles","web_order_line_item_id":"350000026263110","is_trial_period":"false"},{"quantity":"1","product_id":"com.busuu.app.subs1monthoptionC.switzerland","transaction_id":"140000170968732","original_transaction_id":"140000164971107","purchase_date":"2015-11-13 11:38:17 Etc/GMT","purchase_date_ms":"1447414697000","purchase_date_pst":"015-11-13 03:38:17 America/Los_Angeles","original_purchase_date":"2015-10-13 10:38:22 Etc/GMT","original_purchase_date_ms":"1444732702000","original_purchase_date_pst":"2015-10-13 03:38:22 America/Los_Angeles","expires_date":"2015-12-13 11:38:17 Etc/GMT","expires_date_ms":"1450006697000","expires_date_pst":"2015-12-13 03:38:17 America/Los_Angeles","web_order_line_item_id":"140000019536111","is_trial_period":"false"}],"latest_receipt":"ZZZ"}', true);
    }

    public function getStoreReceiptDataNoPurchase()
    {
        return json_decode('{"status":0,"environment":"Production","receipt":{"receipt_type":"Production","adam_id":379968583,"app_item_id":379968583,"bundle_id":"com.busuu.english.app","application_version":"2","download_id":83018699889059,"version_external_identifier":818322555,"receipt_creation_date":"2016-08-18 09:00:45 Etc\/GMT","receipt_creation_date_ms":"1471510845000","receipt_creation_date_pst":"2016-08-18 02:00:45 America\/Los_Angeles","request_date":"2016-08-18 10:25:07 Etc\/GMT","request_date_ms":"1471515907507","request_date_pst":"2016-08-18 03:25:07 America\/Los_Angeles","original_purchase_date":"2016-08-18 09:00:45 Etc\/GMT","original_purchase_date_ms":"1471510845000","original_purchase_date_pst":"2016-08-18 02:00:45 America\/Los_Angeles","original_application_version":"2","in_app":[]}}', true);
    }

    public function getStoreReceiptLatestSubscriptionIsCancelled()
    {
        return json_decode('{"status":0,"environment":"Production","receipt":{"receipt_type":"Production","adam_id":379968583,"app_item_id":379968583,"bundle_id":"com.busuu.english.app","application_version":"2","download_id":111031524462354,"version_external_identifier":828554638,"receipt_creation_date":"2018-10-02 13:45:46 Etc\/GMT","receipt_creation_date_ms":"1538487946000","receipt_creation_date_pst":"2018-10-02 06:45:46 America\/Los_Angeles","request_date":"2018-10-03 15:51:48 Etc\/GMT","request_date_ms":"1538581908453","request_date_pst":"2018-10-03 08:51:48 America\/Los_Angeles","original_purchase_date":"2018-08-31 19:43:45 Etc\/GMT","original_purchase_date_ms":"1535744625000","original_purchase_date_pst":"2018-08-31 12:43:45 America\/Los_Angeles","original_application_version":"1000","in_app":[{"quantity":"1","product_id":"com.busuu.app.subs12month_ft_jul_17","transaction_id":"710000326437686","original_transaction_id":"710000326437686","purchase_date":"2018-09-03 08:50:07 Etc\/GMT","purchase_date_ms":"1535964607000","purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","original_purchase_date":"2018-09-03 08:50:07 Etc\/GMT","original_purchase_date_ms":"1535964607000","original_purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","expires_date":"2018-09-10 08:50:07 Etc\/GMT","expires_date_ms":"1536569407000","expires_date_pst":"2018-09-10 01:50:07 America\/Los_Angeles","web_order_line_item_id":"710000085645166","is_trial_period":"true","is_in_intro_offer_period":"false"},{"quantity":"1","product_id":"com.busuu.app.subs12month.50_discount_sep_16","transaction_id":"710000330793142","original_transaction_id":"710000330793142","purchase_date":"2018-09-18 09:56:35 Etc\/GMT","purchase_date_ms":"1537264595000","purchase_date_pst":"2018-09-18 02:56:35 America\/Los_Angeles","original_purchase_date":"2018-09-18 09:56:36 Etc\/GMT","original_purchase_date_ms":"1537264596000","original_purchase_date_pst":"2018-09-18 02:56:36 America\/Los_Angeles","expires_date":"2019-09-18 09:56:35 Etc\/GMT","expires_date_ms":"1568800595000","expires_date_pst":"2019-09-18 02:56:35 America\/Los_Angeles","web_order_line_item_id":"710000087751357","is_trial_period":"false","is_in_intro_offer_period":"false"},{"quantity":"1","product_id":"com.busuu.app.subs12month_ft_jul_17","transaction_id":"710000330793702","original_transaction_id":"710000326437686","purchase_date":"2018-09-18 09:59:25 Etc\/GMT","purchase_date_ms":"1537264765000","purchase_date_pst":"2018-09-18 02:59:25 America\/Los_Angeles","original_purchase_date":"2018-09-03 08:50:07 Etc\/GMT","original_purchase_date_ms":"1535964607000","original_purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","expires_date":"2019-09-18 09:59:25 Etc\/GMT","expires_date_ms":"1568800765000","expires_date_pst":"2019-09-18 02:59:25 America\/Los_Angeles","cancellation_date":"2018-09-20 20:26:39 Etc\/GMT","cancellation_date_ms":"1537475199000","cancellation_date_pst":"2018-09-20 13:26:39 America\/Los_Angeles","web_order_line_item_id":"710000085645167","is_trial_period":"false","is_in_intro_offer_period":"false","cancellation_reason":"0"}]},"latest_receipt_info":[{"quantity":"1","product_id":"com.busuu.app.subs12month_ft_jul_17","transaction_id":"710000326437686","original_transaction_id":"710000326437686","purchase_date":"2018-09-03 08:50:07 Etc\/GMT","purchase_date_ms":"1535964607000","purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","original_purchase_date":"2018-09-03 08:50:07 Etc\/GMT","original_purchase_date_ms":"1535964607000","original_purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","expires_date":"2018-09-10 08:50:07 Etc\/GMT","expires_date_ms":"1536569407000","expires_date_pst":"2018-09-10 01:50:07 America\/Los_Angeles","web_order_line_item_id":"710000085645166","is_trial_period":"true","is_in_intro_offer_period":"false"},{"quantity":"1","product_id":"com.busuu.app.subs12month.50_discount_sep_16","transaction_id":"710000330793142","original_transaction_id":"710000330793142","purchase_date":"2018-09-18 09:56:35 Etc\/GMT","purchase_date_ms":"1537264595000","purchase_date_pst":"2018-09-18 02:56:35 America\/Los_Angeles","original_purchase_date":"2018-09-18 09:56:36 Etc\/GMT","original_purchase_date_ms":"1537264596000","original_purchase_date_pst":"2018-09-18 02:56:36 America\/Los_Angeles","expires_date":"2019-09-18 09:56:35 Etc\/GMT","expires_date_ms":"1568800595000","expires_date_pst":"2019-09-18 02:56:35 America\/Los_Angeles","web_order_line_item_id":"710000087751357","is_trial_period":"false","is_in_intro_offer_period":"false"},{"quantity":"1","product_id":"com.busuu.app.subs12month_ft_jul_17","transaction_id":"710000330793702","original_transaction_id":"710000326437686","purchase_date":"2018-09-18 09:59:25 Etc\/GMT","purchase_date_ms":"1537264765000","purchase_date_pst":"2018-09-18 02:59:25 America\/Los_Angeles","original_purchase_date":"2018-09-03 08:50:07 Etc\/GMT","original_purchase_date_ms":"1535964607000","original_purchase_date_pst":"2018-09-03 01:50:07 America\/Los_Angeles","expires_date":"2019-09-18 09:59:25 Etc\/GMT","expires_date_ms":"1568800765000","expires_date_pst":"2019-09-18 02:59:25 America\/Los_Angeles","cancellation_date":"2018-09-20 20:26:39 Etc\/GMT","cancellation_date_ms":"1537475199000","cancellation_date_pst":"2018-09-20 13:26:39 America\/Los_Angeles","web_order_line_item_id":"710000085645167","is_trial_period":"false","is_in_intro_offer_period":"false","cancellation_reason":"0"}],"latest_receipt":"ZZZ","pending_renewal_info":[{"auto_renew_product_id":"com.busuu.app.subs12month.50_discount_sep_16","original_transaction_id":"710000330793142","product_id":"com.busuu.app.subs12month.50_discount_sep_16","auto_renew_status":"1"},{"auto_renew_product_id":"com.busuu.app.subs12month_ft_jul_17","original_transaction_id":"710000326437686","product_id":"com.busuu.app.subs12month_ft_jul_17","auto_renew_status":"0"}]}', true);
    }
}
